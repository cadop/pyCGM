
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyCGM_Single.Pipelines.butterFilter &#8212; pycgm 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pyCGM_Single.Pipelines.clearMarker" href="pyCGM_Single.Pipelines.clearMarker.html" />
    <link rel="prev" title="pyCGM_Single.Pipelines.butter" href="pyCGM_Single.Pipelines.butter.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pycgm-single-pipelines-butterfilter">
<h1>pyCGM_Single.Pipelines.butterFilter<a class="headerlink" href="#pycgm-single-pipelines-butterfilter" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="pyCGM_Single.Pipelines.butterFilter">
<code class="sig-prename descclassname">pyCGM_Single.Pipelines.</code><code class="sig-name descname">butterFilter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">cutoff</span></em>, <em class="sig-param"><span class="n">Fs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCGM_Single.Pipelines.butterFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a fourth order Butterworth filter.</p>
<p>Fourth order Butterworth filter to be used in filt() and filter_mask_nans()
functions, which are in Utilities. Filter is applied forward and backwards
with the filtfilt() function – see Notes for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">1darray or list</span></dt><dd><p>Data to be filtered.</p>
</dd>
<dt><strong>cutoff</strong><span class="classifier">int</span></dt><dd><p>Desired cutoff frequency.</p>
</dd>
<dt><strong>Fs</strong><span class="classifier">int</span></dt><dd><p>Sampling frequency signal was acquired at.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>1darray</dt><dd><p>1D numpy array of the signal after applying the filter.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Applying the filter one way will create a phase shift of the output
signal compared to the input signal. For a 2nd order filter, this will
be 90 degrees. Thus, filtfilt applies the signal once forward and once
backward, which is referred to as phase correction. Whilst this brings
the net phase shift to zero, it also means the cutoff of the filter will
be twice as sharp when compared to a single filtering. In effect, a 2nd
order filter applied twice will be a 4th order filter. We can apply a
correction factor to the cutoff frequency to compensate. Correction
factor <img class="math" src="../_images/math/c857f9e573fab12b0ceb851db53c0dd11ee1bd19.png" alt="C=\sqrt{2^{1/n-1}}"/> where <cite>n</cite> is equal to the number of passes.</p>
<p class="rubric">Examples</p>
<p>First, we create a sin wave and add noise to it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span><span class="p">,</span> <span class="n">around</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Fs</span> <span class="o">=</span> <span class="mf">360.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">around</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">array([ 0.        ,  0.17364818,  0.34202014,  0.5       ,  0.64278761,</span>
<span class="go">        0.76604444,  0.8660254 ,  0.93969262,  0.98480775,  1.        ,</span>
<span class="go">        0.98480775,  0.93969262,  0.8660254 ,  0.76604444,  0.64278761,</span>
<span class="go">        0.5       ,  0.34202014,  0.17364818,  0.        , -0.17364818,</span>
<span class="go">       -0.34202014, -0.5       , -0.64278761, -0.76604444, -0.8660254 ,</span>
<span class="go">       -0.93969262, -0.98480775, -1.        , -0.98480775, -0.93969262,</span>
<span class="go">       -0.8660254 , -0.76604444, -0.64278761, -0.5       , -0.34202014,</span>
<span class="go">       -0.17364818, -0.        ,...</span>
</pre></div>
</div>
<p>Add noise.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">shape</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">+=</span> <span class="n">noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">around</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> 
<span class="go">array([ 0.07311482,  0.10988896,  0.25388809,  0.34281796,  0.63076505,</span>
<span class="go">        0.80085072,  0.80731281,  1.00976795,  0.98101546,  1.09391764,</span>
<span class="go">        0.94797884,  0.86082217,  0.74357311,  0.77169265,  0.62679276,</span>
<span class="go">        0.58882546,  0.09397977,  0.17420432,  0.05079215, -0.16508813,</span>
<span class="go">       -0.30257866, -0.59281001, -0.73830443, -0.75690063, -0.69030496,</span>
<span class="go">       -0.90486956, -0.93386976, -0.77240548, -0.95216637, -0.89735706,</span>
<span class="go">       -0.9181403 , -0.83423091, -0.53978573, -0.51704481, -0.32342007,</span>
<span class="go">       -0.09202642,  0.18458246,...</span>
</pre></div>
</div>
<p>Filter the signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">butterFilter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">Fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> 
<span class="go">array([ 0.08064958,  0.2200619 ,  0.3571366 ,  0.48750588,  0.6068546 ,</span>
<span class="go">        0.71108837,  0.79649951,  0.85992252,  0.89887073,  0.91164625,</span>
<span class="go">        0.89741714,  0.85625827,  0.78915455,  0.69796821,  0.58537283,</span>
<span class="go">        0.45475822,  0.31011048,  0.15587271, -0.00320784, -0.1622398 ,</span>
<span class="go">       -0.31634916, -0.46083652, -0.59132481, -0.70389233, -0.79518671,</span>
<span class="go">       -0.86251753, -0.90392645, -0.91823542, -0.9050733 , -0.86488133,</span>
<span class="go">       -0.79889735, -0.7091183 , -0.59824082, -0.46958083, -0.32697445,</span>
<span class="go">       -0.17466424, -0.01717538,...</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pycgm</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted.html">Getting Started with pycgm</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API for pycgm</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pyCGM.html">pyCGM_Single.pyCGM</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pycgmKinetics.html">pyCGM_Single.pycgmKinetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pycgmIO.html">pyCGM_Single.pycgmIO</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="pyCGM_Single.Pipelines.html">pyCGM_Single.Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pyCGM_Helpers.html">pyCGM_Single.pyCGM_Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pycgmCalc.html">pyCGM_Single.pycgmCalc</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pycgmStatic.html">pyCGM_Single.pycgmStatic</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.clusterCalc.html">pyCGM_Single.clusterCalc</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyCGM_Single.pycgmClusters.html">pyCGM_Single.pycgmClusters</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../API.html">API for pycgm</a><ul>
  <li><a href="pyCGM_Single.Pipelines.html">pyCGM_Single.Pipelines</a><ul>
      <li>Previous: <a href="pyCGM_Single.Pipelines.butter.html" title="previous chapter">pyCGM_Single.Pipelines.butter</a></li>
      <li>Next: <a href="pyCGM_Single.Pipelines.clearMarker.html" title="next chapter">pyCGM_Single.Pipelines.clearMarker</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Mathew Schwartz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/generated/pyCGM_Single.Pipelines.butterFilter.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>